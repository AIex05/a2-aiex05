<!DOCTYPE html>
<html lang="en">

<head>
  <title>CS4241 Assignment 2</title>
  <meta charset="utf-8" />
  <link rel="stylesheet" href="./style.css" />
</head>

<body>
  <form action="">
    <h1>Welcome to Everyday Quest</h1>
    <p>The fields are (School, Life, Challenge)</p>
    <p>Type in the field you want to work on:</p>
    <input type="text" id="yourname" value="Challenge" />
    <button id="Submit">submit</button>
    <p>if you want to retreive a quest:</p>
    <P id="QuestReceived">What ever is the quest (will be generated)</P>
    <button id="Done">I did it! (not done)</botton>
      <button style="margin-left: 50px" id="NotDone">I did not :( (not done)</button>
      <h3>How many things done?</h3>
      <p id="GetDoneNum">You got nothing done today</p>
    <button id="Result">Get Database</button>
  </form>
</body>
<script>
  const submit = function (e) {
    // prevent default form action from being carried out
    e.preventDefault();

    const input = document.querySelector("#yourname"),
      json = { yourname: input.value },
      body = JSON.stringify(json);

    fetch("/submit", {
      method: "POST",
      body,
    })
      .then((response) => {
        return response.json();
      })
      .then((json) => {
        const quest = document.body.querySelector("#QuestReceived");
        const Quest = json.Quest;
        quest.innerText = Quest;
        /*
        for (let i = 0;i < test;i++) {

        }

        json.forEach((item) => {
          const p = JSON.stringify(item);
          quest.innerText = p;
        });
        */
        /*
        json.forEach((item) => {
          const p = document.createElement("p");
          p.innerText = JSON.stringify(item);
          const quest = document.body.querySelector("#QuestReceived");
          quest.innerText = p.innerText;
        });
        */
      })
      .then(function (response) {
        // do something with the reponse 
        console.log(response)
      })

    return false;
  };

  const Done = function (e) {
    e.preventDefault();

    Q_element = document.querySelector("#QuestReceived")
    body = "NoDo" + Q_element.innerText

    fetch("/submit", {
      method: "POST",
      body,
    })
      .then((response) => {
        return response.json();
      })

    return false;
  };

  const NotDone = function (e) {
    e.preventDefault();

    const input = document.querySelector("#yourname"),
      json = { yourname: input.value },
      body = JSON.stringify(json);

    fetch("/submit", {
      method: "POST",
      body,
    })
      .then((response) => {
        return response.json();
      })
      .then((json) => {
        json.forEach((item) => {
          const p = document.createElement("p");
          p.innerText = JSON.stringify(item);
          const quest = document.body.querySelector("#QuestReceived");
          quest.innerText = p.innerText;
        });
      })
      .then(function (response) {
        // do something with the reponse 
        console.log(response)
      })

    return false;
  };
  
  const Result = function (e) {
    
    e.preventDefault();
    body = "GetAllData"

    fetch("/submit", {
      method: "POST",
      body,
    })
      .then((response) => {
        return response.json();
      })
      .then((json) => {
        json.forEach((item) => {
          const p = document.createElement("p");
          p.innerText = JSON.stringify(item.Quest);
          document.body.appendChild(p);
        });
      })
      .then(function (response) {
        // do something with the reponse 
        console.log(response)
      })

    return false;
  };

  window.onload = function () {
    const button_submit = document.querySelector("#Submit");
    button_submit.onclick = submit;
    const button_done = document.querySelector("#Done");
    button_done.onclick = Done;
    const button_Notdone = document.querySelector("#NotDone");
    button_Notdone.onclick = NotDone;
    const button_Result = document.querySelector("#Result");
    button_Result.onclick = Result;
  };
</script>

</html>